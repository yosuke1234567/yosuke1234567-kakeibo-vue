import{c as W,ak as X,al as H,a as N,b as $,Q as J,an as aa,f as Y,r as i,o as P,E as ea,s as g,B as w,L as ta,R as la,j as A,k as T,F as sa,U as oa,l as na,m as k,q as p,n as s,w as r,aW as C,v as D,C as m,Z as y,aX as ua,x as ca,y as ra,z as da,A as ia,aY as va,aD as fa,aC as Q,P as _a,_ as ga}from"./index.f2e67699.js";import{Q as x}from"./QCard.a9861059.js";import{u as ma,g as R,Q as U}from"./updateMonthlyData.8e2be468.js";import{Q as ha,j,k as pa}from"./QCardActions.372ce999.js";import{C as F,p as ba,a as ya,b as Sa,B as ka,c as wa,L as Ca,d as Da,g as M,_ as xa}from"./getDoughnutValue.67f5313f.js";const Ba=W({name:"QAvatar",props:{...X,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(l,{slots:t}){const d=H(l),v=N(()=>"q-avatar"+(l.color?` bg-${l.color}`:"")+(l.textColor?` text-${l.textColor} q-chip--colored`:"")+(l.square===!0?" q-avatar--square":l.rounded===!0?" rounded-borders":"")),f=N(()=>l.fontSize?{fontSize:l.fontSize}:null);return()=>{const u=l.icon!==void 0?[$(J,{name:l.icon})]:void 0;return $("div",{class:v.value,style:d.value},[$("div",{class:"q-avatar__content row flex-center overflow-hidden",style:f.value},aa(t.default,u))])}}}),qa="/yosuke1234567-kakeibo-vue/assets/honey.22310c83.png",Va=Y({__name:"BarChart",props:{chartValue:null,labels:null,bg:null,setMonth:null},setup(l){const t=l;F.register(ba,ya,Sa,ka,wa,Ca),F.defaults.font.family="'Asap', 'Zen Maru Gothic', sans-serif",F.defaults.aspectRatio=1.333;const d=i({labels:[],datasets:[]}),v=()=>{d.value.datasets[0].data=t.chartValue,d.value.datasets[0].backgroundColor=t.bg};P(()=>{d.value={labels:t.labels,datasets:[{borderColor:"#f5f2eb",borderRadius:8,backgroundColor:t.bg,data:t.chartValue}]}}),ea(t,v);const f={scales:{x:{grid:{color:"transparent"}},y:{ticks:{maxTicksLimit:6}}},plugins:{legend:{display:!1}},layout:{padding:20},onClick(u,c,o){console.log(u,c,o),t.setMonth(c[0].index)}};return(u,c)=>(g(),w(ta(Da),{"chart-data":d.value,"chart-options":f},null,8,["chart-data"]))}}),z=async l=>{const t=la(T,A.currentUser.uid),d=sa(t,oa("statsMonth")),v=await na(d),f=[];v.forEach(o=>f.push(o.data())),console.log(f);const u=[];for(let o=0;o<6;o++)for(let n=0;n<f.length;n++)if(l[o]===f[n].statsMonth){u[o]=f[n].expense;break}else u[o]=[{amount:0}];console.log(u);const c=[];for(let o=0;o<6;o++){let n=0;for(let h=0;h<u[o].length;h++)n+=u[o][h].amount;c.push(n)}return console.log(c),c},E=l=>(da("data-v-3f4113dd"),l=l(),ia(),l),$a={class:"u-inner"},Qa=E(()=>p("h2",null,"\u7D71\u8A08",-1)),Fa={class:"chart-wrap"},Ma={class:"amount-area"},za={key:0},Aa={key:0},Ea={class:"pagination"},La={key:0,class:"detail-wrap"},Ia={class:"detail-title"},Na=E(()=>p("img",{src:qa,alt:"",draggable:"false"},null,-1)),Ra=E(()=>p("div",null,"\u524A\u9664\u3057\u307E\u3059\u304B\uFF1F",-1)),Ua=Y({__name:"Stats",setup(l){const t=i([]),d=new Date,v=i(d.getMonth()+1),f=()=>{for(let e=0;e<6;e++)if(v.value-e>0)if(v.value-e<13){const a=(v.value-e).toString().padStart(2,"0");t.value.unshift(`${d.getFullYear()}-${a}`)}else{const a=(v.value-e-12).toString().padStart(2,"0");t.value.unshift(`${d.getFullYear()+1}-${a}`)}else{const a=(12-(e-v.value)).toString().padStart(2,"0");t.value.unshift(`${d.getFullYear()-1}-${a}`)}console.log(t.value)},u=i([]),c=i([]),o=i(["#ddd0bb","#ddd0bb","#ddd0bb","#ddd0bb","#ddd0bb","#fdd835"]),n=i(`${d.getFullYear()}-${d.getMonth()+1}`),h=i(5),b=i(),B=i(0),Z=async e=>{n.value!==t.value[e]&&(V.value=!1),h.value=e,n.value=t.value[e],b.value=c.value[e],B.value=0;for(let a=0;a<6;a++)o.value[a]=a==e?"#fdd835":"#ddd0bb";u.value=await M(n.value)},q=i([]),V=i(!1),S=i(!1),L=i();P(async()=>{A.currentUser&&(f(),c.value=await z(t.value),u.value=await M(n.value),b.value=c.value[5])});const I=async e=>{v.value=v.value+e,t.value.splice(0),f(),B.value+=e>0?1:-1;for(let a=0;a<6;a++)B.value==0?o.value[a]=a==h.value?"#fdd835":"#ddd0bb":o.value[a]="#ddd0bb";c.value=await z(t.value)},G=async()=>{const e=new Date(n.value).getTime();q.value=await R(e),V.value=!0},K=e=>{L.value=_a(T,A.currentUser.uid,`expense-${e}`),S.value=!0},O=async()=>{const e=new Date(n.value).getTime();await va(L.value),await ma(e),q.value=await R(e),c.value=await z(t.value),u.value=await M(n.value),b.value=c.value[h.value],S.value=!1};return(e,a)=>(g(),k("div",$a,[Qa,p("div",Fa,[s(x,{class:"q-py-md q-mb-lg radius-8"},{default:r(()=>[p("div",Ma,[D(m(n.value.slice(0,4))+"\u5E74 "+m(new Date(n.value).getMonth()+1)+"\u6708 ",1),b.value||b.value==0?(g(),k("span",za,"\uFFE5"+m(b.value.toLocaleString()),1)):C("",!0)]),c.value.length?(g(),k("div",Aa,[s(Va,{"chart-value":c.value,labels:t.value,bg:o.value,"set-month":Z},null,8,["chart-value","labels","bg"]),p("div",Ea,[s(y,{onClick:a[0]||(a[0]=_=>I(-6)),icon:"sym_r_navigate_before",size:"md",flat:"",round:"",class:"q-mr-sm"}),s(y,{onClick:a[1]||(a[1]=_=>I(6)),icon:"sym_r_navigate_next",size:"md",flat:"",round:""})])])):C("",!0)]),_:1}),u.value.length?(g(),w(x,{key:0,class:"radius-8"},{default:r(()=>[s(xa,{"chart-value":u.value},null,8,["chart-value"])]),_:1})):C("",!0)]),u.value.length?(g(),k("div",La,[V.value?(g(),w(x,{key:0,transition:"fade",class:"full-width"},{default:r(()=>[p("div",Ia,m(n.value.slice(0,4))+"\u5E74 "+m(new Date(n.value).getMonth()+1)+"\u6708 ",1),s(j,{class:"q-py-sm"},{default:r(()=>[s(ua,{separator:""},{default:r(()=>[(g(!0),k(ca,null,ra(q.value,_=>(g(),w(fa,{class:"q-pa-md"},{default:r(()=>[s(Q,{avatar:"",class:"q-pr-lg"},{default:r(()=>[s(Ba,{color:"primary","text-color":"white",size:"md",rounded:""},{default:r(()=>[D(m(_.date.slice(8)),1)]),_:2},1024)]),_:2},1024),s(Q,null,{default:r(()=>[s(U,null,{default:r(()=>[D("\uFFE5"+m(_.amount.toLocaleString())+" - "+m(_.category),1)]),_:2},1024),s(U,{caption:""},{default:r(()=>[D(m(_.memo),1)]),_:2},1024)]),_:2},1024),s(Q,{side:""},{default:r(()=>[s(y,{onClick:ja=>K(_.createdAt),icon:"sym_r_delete",size:"md",flat:"",round:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1}),s(ha,{modelValue:S.value,"onUpdate:modelValue":a[3]||(a[3]=_=>S.value=_)},{default:r(()=>[s(x,{class:"dialog-card"},{default:r(()=>[s(j,{class:"dialog-section"},{default:r(()=>[Na,Ra]),_:1}),s(pa,{class:"justify-end"},{default:r(()=>[s(y,{label:"\u30AD\u30E3\u30F3\u30BB\u30EB",onClick:a[2]||(a[2]=_=>S.value=!1),class:"col"}),s(y,{label:"OK",onClick:O,color:"secondary","text-color":"initial",class:"col"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(g(),w(y,{key:1,onClick:G,label:"\u8A73\u7D30\u3092\u8868\u793A",color:"secondary","text-color":"initial",padding:"10px 32px",class:"block q-mx-auto q-mt-sm"}))])):C("",!0)]))}});const Ka=ga(Ua,[["__scopeId","data-v-3f4113dd"]]);export{Ka as default};
