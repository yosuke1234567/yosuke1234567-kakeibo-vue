import{c as J,al as W,am as X,a as R,b as Q,Q as aa,ao as ea,f as T,r,o as Y,G as ta,m as g,B as C,M as la,R as sa,j as E,k as G,F as oa,U as ua,l as na,n as w,s as p,q as u,w as n,aY as k,v as x,C as h,$ as y,aZ as ca,x as ra,y as da,z as ia,A as va,a_ as fa,a$ as _a,aF as ma,aE as M,P as ga,D as ha}from"./index.ff1da430.js";import{Q as D}from"./QCard.0c48627a.js";import{g as U,u as pa,Q as j}from"./updateMonthlyData.07a5f00d.js";import{Q as ba,j as P,k as ya}from"./QCardActions.9447d791.js";import{C as F,p as Sa,a as wa,b as Ca,B as ka,c as xa,L as Da,d as Ba,g as z,_ as $a}from"./getDoughnutValue.c10dcf48.js";const qa=J({name:"QAvatar",props:{...W,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(s,{slots:t}){const i=X(s),_=R(()=>"q-avatar"+(s.color?` bg-${s.color}`:"")+(s.textColor?` text-${s.textColor} q-chip--colored`:"")+(s.square===!0?" q-avatar--square":s.rounded===!0?" rounded-borders":"")),o=R(()=>s.fontSize?{fontSize:s.fontSize}:null);return()=>{const v=s.icon!==void 0?[Q(aa,{name:s.icon})]:void 0;return Q("div",{class:_.value,style:i.value},[Q("div",{class:"q-avatar__content row flex-center overflow-hidden",style:o.value},ea(t.default,v))])}}}),Va=T({__name:"BarChart",props:{chartValue:null,labels:null,bg:null,setMonth:null},setup(s){const t=s;F.register(Sa,wa,Ca,ka,xa,Da),F.defaults.font.family="'Asap', 'Zen Maru Gothic', sans-serif",F.defaults.aspectRatio=1.333;const i=r({labels:[],datasets:[]}),_=()=>{i.value.datasets[0].data=t.chartValue,i.value.datasets[0].backgroundColor=t.bg};Y(()=>{i.value={labels:t.labels,datasets:[{borderColor:"#f5f2eb",borderRadius:8,backgroundColor:t.bg,data:t.chartValue}]}}),ta(t,_);const o={scales:{x:{grid:{color:"transparent"}},y:{ticks:{maxTicksLimit:6}}},plugins:{legend:{display:!1}},layout:{padding:20},onClick(v,d,l){console.log(v,d,l),t.setMonth(d[0].index)}};return(v,d)=>(g(),C(la(Ba),{"chart-data":i.value,"chart-options":o},null,8,["chart-data"]))}}),A=async s=>{const t=sa(G,E.currentUser.uid),i=oa(t,ua("statsMonth")),_=await na(i),o=[];_.forEach(l=>o.push(l.data())),console.log(o);const v=[];for(let l=0;l<6;l++)for(let f=0;f<o.length;f++)if(s[l]===o[f].statsMonth){v[l]=o[f].expense;break}else v[l]=[{amount:0}];console.log(v);const d=[];for(let l=0;l<6;l++){let f=0;for(let c=0;c<v[l].length;c++)f+=v[l][c].amount;d.push(f)}return console.log(d),d},I=s=>(ia("data-v-cf9c77c9"),s=s(),va(),s),Qa={class:"u-inner"},Ma=I(()=>p("h2",null,"\u7D71\u8A08",-1)),Fa={class:"chart-wrap"},za={class:"amount-area"},Aa={key:0},Ea={key:0},Ia={class:"pagination"},La={key:0,class:"detail-wrap"},Na={class:"detail-title"},Ra=I(()=>p("img",{src:fa,alt:"",draggable:"false"},null,-1)),Ua=I(()=>p("div",null,"\u524A\u9664\u3057\u307E\u3059\u304B\uFF1F",-1)),ja=T({__name:"Stats",setup(s){const t=r([]),i=new Date,_=r(i.getFullYear()),o=r(i.getMonth()+1),v=()=>{for(let a=0;a<6;a++)if(o.value-a>0)if(o.value-a<13){const e=(o.value-a).toString().padStart(2,"0");t.value.unshift(`${_.value}-${e}`)}else{const e=(o.value-a-12).toString().padStart(2,"0");t.value.unshift(`${_.value+1}-${e}`)}else{const e=(12-(a-o.value)).toString().padStart(2,"0");t.value.unshift(`${_.value-1}-${e}`)}console.log(t.value)},d=r([]),l=r([]),f=r(["#ddd0bb","#ddd0bb","#ddd0bb","#ddd0bb","#ddd0bb","#fdd835"]),c=r(`${i.getFullYear()}-${(i.getMonth()+1).toString().padStart(2,"0")}`),B=r(5),b=r(),$=r(0),Z=async a=>{c.value!==t.value[a]&&(V.value=!1),B.value=a,c.value=t.value[a],b.value=l.value[a],$.value=0;for(let e=0;e<6;e++)f.value[e]=e==a?"#fdd835":"#ddd0bb";d.value=await z(c.value)},q=r([]),V=r(!1),S=r(!1),L=r();Y(async()=>{E.currentUser&&(v(),l.value=await A(t.value),d.value=await z(c.value),b.value=l.value[5])});const N=async a=>{o.value+a<=-6?(_.value=_.value-1,o.value=o.value+a+12):o.value=o.value+a,t.value.splice(0),v(),$.value+=a>0?1:-1;for(let e=0;e<6;e++)$.value==0?f.value[e]=e==B.value?"#fdd835":"#ddd0bb":f.value[e]="#ddd0bb";l.value=await A(t.value)},K=async()=>{const a=new Date(c.value).getTime();q.value=await U(a),V.value=!0},O=a=>{L.value=ga(G,E.currentUser.uid,`expense-${a}`),S.value=!0},H=async()=>{const a=new Date(c.value).getTime();await _a(L.value),await pa(a),q.value=await U(a),l.value=await A(t.value),d.value=await z(c.value),b.value=l.value[B.value],S.value=!1};return(a,e)=>(g(),w("div",Qa,[Ma,p("div",Fa,[u(D,{class:"q-py-md q-mb-lg radius-8"},{default:n(()=>[p("div",za,[x(h(c.value.slice(0,4))+"\u5E74 "+h(c.value.slice(5,7))+"\u6708 ",1),b.value||b.value==0?(g(),w("span",Aa,"\uFFE5"+h(b.value.toLocaleString()),1)):k("",!0)]),l.value.length?(g(),w("div",Ea,[u(Va,{"chart-value":l.value,labels:t.value,bg:f.value,"set-month":Z},null,8,["chart-value","labels","bg"]),p("div",Ia,[u(y,{onClick:e[0]||(e[0]=m=>N(-6)),icon:"sym_r_navigate_before",size:"md",flat:"",round:"",class:"q-mr-sm"}),u(y,{onClick:e[1]||(e[1]=m=>N(6)),icon:"sym_r_navigate_next",size:"md",flat:"",round:""})])])):k("",!0)]),_:1}),d.value.length?(g(),C(D,{key:0,class:"radius-8"},{default:n(()=>[u($a,{"chart-value":d.value},null,8,["chart-value"])]),_:1})):k("",!0)]),d.value.length?(g(),w("div",La,[V.value?(g(),C(D,{key:0,transition:"fade",class:"full-width"},{default:n(()=>[p("div",Na,h(c.value.slice(0,4))+"\u5E74 "+h(new Date(c.value).getMonth()+1)+"\u6708 ",1),u(P,{class:"q-py-sm"},{default:n(()=>[u(ca,{separator:""},{default:n(()=>[(g(!0),w(ra,null,da(q.value,m=>(g(),C(ma,{class:"q-pa-md"},{default:n(()=>[u(M,{avatar:"",class:"q-pr-lg"},{default:n(()=>[u(qa,{color:"primary","text-color":"white",size:"md",rounded:""},{default:n(()=>[x(h(m.date.slice(8)),1)]),_:2},1024)]),_:2},1024),u(M,null,{default:n(()=>[u(j,null,{default:n(()=>[x("\uFFE5"+h(m.amount.toLocaleString())+" - "+h(m.category),1)]),_:2},1024),u(j,{caption:""},{default:n(()=>[x(h(m.memo),1)]),_:2},1024)]),_:2},1024),u(M,{side:""},{default:n(()=>[u(y,{onClick:Pa=>O(m.createdAt),icon:"sym_r_delete",size:"md",flat:"",round:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1}),u(ba,{modelValue:S.value,"onUpdate:modelValue":e[3]||(e[3]=m=>S.value=m)},{default:n(()=>[u(D,{class:"dialog-card"},{default:n(()=>[u(P,{class:"dialog-section"},{default:n(()=>[Ra,Ua]),_:1}),u(ya,{class:"justify-end"},{default:n(()=>[u(y,{label:"\u30AD\u30E3\u30F3\u30BB\u30EB",onClick:e[2]||(e[2]=m=>S.value=!1),class:"col"}),u(y,{label:"OK",onClick:H,color:"secondary","text-color":"initial",class:"col"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(g(),C(y,{key:1,onClick:K,label:"\u8A73\u7D30\u3092\u8868\u793A",color:"secondary","text-color":"initial",padding:"10px 32px",class:"block q-mx-auto q-mt-sm"}))])):k("",!0)]))}});const Oa=ha(ja,[["__scopeId","data-v-cf9c77c9"]]);export{Oa as default};
